## excelæ–‡ä»¶

## ä»£ç 
```py
import datetime
from pathlib import Path
from openpyxl import load_workbook

# è·å–å½“å‰æ—¥æœŸï¼Œç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹
current_date = datetime.datetime.now().strftime("%Y%m%d")
new_folder = Path(current_date)

# åˆ›å»ºä»¥å½“å‰æ—¥æœŸå‘½åçš„æ–‡ä»¶å¤¹ï¼ˆè‹¥ä¸å­˜åœ¨ï¼‰
new_folder.mkdir(exist_ok=True)
print(f"ä½¿ç”¨æ–‡ä»¶å¤¹ {new_folder}")

# å®šä¹‰æ¨¡æ¿æ–‡ä»¶å’Œä¿¡æ¯æ–‡ä»¶è·¯å¾„
template_file = Path("S57-48å£åˆå§‹åŒ–.cfg")
info_file = Path("é…ç½®.xlsx")

# æ£€æŸ¥æ¨¡æ¿æ–‡ä»¶å’Œ Excel æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if not template_file.exists():
    raise FileNotFoundError(f"æ¨¡æ¿æ–‡ä»¶ {template_file} ä¸å­˜åœ¨ï¼")
if not info_file.exists():
    raise FileNotFoundError(f"Excel æ–‡ä»¶ {info_file} ä¸å­˜åœ¨ï¼")

# åŠ è½½Excelæ–‡ä»¶
wb = load_workbook(filename=info_file)
sheet = wb.active

# è¯»å–æ¨¡æ¿æ–‡ä»¶å†…å®¹ï¼Œå¹¶å»æ‰æ³¨é‡Šè¡Œ
with template_file.open('r', encoding='utf-8') as template:
    template_content = ''.join(line for line in template if not line.strip().startswith('#'))

# è·å–Excelä¸­çš„æ•°æ®ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶
for row_index, row in enumerate(sheet.iter_rows(min_row=2, values_only=True), start=2):
    # æ£€æŸ¥æ¯ä¸€è¡Œçš„æ•°æ®å®Œæ•´æ€§ï¼Œç¡®ä¿æ²¡æœ‰ä¸ºç©ºçš„å­—æ®µ
    if any(cell is None for cell in row):
        raise ValueError(f"âŒ [é”™è¯¯] Excel ç¬¬ {row_index} è¡Œæ•°æ®ç¼ºå¤±: {row}")
    
    esn, mgmt_vlan, vlanid_raw, ip1, ip2, ip3, username, passwd = row

    # **å¤„ç† VLAN IDï¼ˆç©ºæ ¼åˆ†éš”ï¼‰**
    if isinstance(vlanid_raw, str):
        vlanid_list = [int(v.strip()) for v in vlanid_raw.split() if v.strip().isdigit()]
    elif isinstance(vlanid_raw, (int, float)):
        vlanid_list = [int(vlanid_raw)]
    else:
        raise ValueError(f"âŒ [é”™è¯¯] Excel ç¬¬ {row_index} è¡Œ VLAN ID æ ¼å¼é”™è¯¯: {vlanid_raw}")

    vlanid_str = ' '.join(map(str, vlanid_list))  # ç”Ÿæˆå­—ç¬¦ä¸²å½¢å¼ "10 20 30"

    # ç”Ÿæˆæ–‡ä»¶å†…å®¹ï¼Œä¸åŒ…æ‹¬ esn
    try:
        file_content = template_content.format(
            mgmt_vlan=mgmt_vlan, vlanid=vlanid_str, ip1=ip1, ip2=ip2, ip3=ip3, 
            username=username, passwd=passwd
        )
    except KeyError as e:
        print(f"âŒ [é”™è¯¯] æ¨¡æ¿å˜é‡ç¼ºå¤±: {e}")
        continue

    # ç”Ÿæˆæ–‡ä»¶åï¼šESN_IP.cfgï¼ˆESNä»…ç”¨äºæ–‡ä»¶åï¼‰
    file_path = new_folder / f"{esn}_{ip1}.cfg"
    with file_path.open('w', encoding='utf-8', errors='replace') as output_file:
        output_file.write(file_content)

    print(f"âœ… ç”Ÿæˆæ–‡ä»¶ {file_path}")

print("ğŸ‰ è„šæœ¬æ‰§è¡Œå®Œæˆï¼")